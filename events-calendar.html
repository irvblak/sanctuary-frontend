
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Events Diary – Calendar View</title>
  <link rel="stylesheet" href="styles.css">
</head>
<body class="calendar-page-body">
<div class="top-nav">
  <a href="index.html" class="top-nav-home">Home</a>
  <a href="#" id="logout-link" class="top-nav-logout">Logout</a>
</div>
  
  <header>
    <!-- You can keep your existing site header/nav here -->
  </header>

  <main class="page events-calendar">
    <section class="page-header">
      <h1>Events Diary – Calendar View</h1>
      <p>A monthly view of all upcoming events.</p>
      <a class="button-secondary" href="events.html">View as list</a>
    </section>

    <section class="calendar-controls">
      <button id="prev-month" type="button">&laquo; Previous</button>
      <div id="calendar-month-label"></div>
      <button id="next-month" type="button">Next &raquo;</button>
    </section>

    <section class="calendar-grid" id="calendar-grid">
      <!-- Calendar cells will be generated by JavaScript -->
    </section>

    <p class="events-note">
      <span class="legend-box legend-free"></span> Free event
      &nbsp;&nbsp;
      <span class="legend-box legend-payable"></span> Payable event
    </p>
  </main>

  <script>
    // Simple mock data for now – later this will call /api/events
    const sampleEvents = [
      { date: '2026-01-17', title: 'Burns Night Supper', payable: true },
      { date: '2026-01-25', title: 'Film Night – Classic Cinema', payable: false },
      { date: '2026-02-01', title: 'Quiz Night', payable: true },
      { date: '2026-02-10', title: 'Bingo Evening', payable: false },
    ];

    let currentMonth = new Date().getMonth();
    let currentYear = new Date().getFullYear();

    const monthLabel = document.getElementById('calendar-month-label');
    const grid = document.getElementById('calendar-grid');
    const prevBtn = document.getElementById('prev-month');
    const nextBtn = document.getElementById('next-month');

    const monthNames = [
      'January','February','March','April','May',
      'June','July','August','September','October','November','December'
    ];

    function renderCalendar(year, month) {
      grid.innerHTML = '';
      monthLabel.textContent = monthNames[month] + ' ' + year;

      const firstDay = new Date(year, month, 1);
      const startingWeekday = firstDay.getDay(); // 0 = Sunday, 1 = Monday...
      const daysInMonth = new Date(year, month + 1, 0).getDate();

      // We’ll label Monday-Sunday across the top
      const weekdays = ['Mon','Tue','Wed','Thu','Fri','Sat','Sun'];
      const headerRow = document.createElement('div');
      headerRow.className = 'calendar-row calendar-weekdays';
      weekdays.forEach(label => {
        const cell = document.createElement('div');
        cell.className = 'calendar-cell weekday-label';
        cell.textContent = label;
        headerRow.appendChild(cell);
      });
      grid.appendChild(headerRow);

      // Determine offset: convert JS Sunday-0 scheme to Monday-0
      const offset = (startingWeekday + 6) % 7; 

      let day = 1;
      for (let week = 0; week < 6; week++) {
        const row = document.createElement('div');
        row.className = 'calendar-row';

        for (let wd = 0; wd < 7; wd++) {
          const cell = document.createElement('div');
          cell.className = 'calendar-cell';

          if ((week === 0 && wd < offset) || day > daysInMonth) {
            cell.classList.add('empty-cell');
          } else {
            const cellDate = new Date(year, month, day);
            const isoDate = cellDate.toISOString().slice(0,10);

            const dayNumber = document.createElement('div');
            dayNumber.className = 'day-number';
            dayNumber.textContent = day;
            cell.appendChild(dayNumber);

            // Find events on this date
            const todaysEvents = sampleEvents.filter(ev => ev.date === isoDate);
            todaysEvents.forEach(ev => {
              const evDiv = document.createElement('div');
              evDiv.className = 'calendar-event ' + (ev.payable ? 'payable' : 'free');
              evDiv.textContent = ev.title;
              cell.appendChild(evDiv);
            });

            day++;
          }

          row.appendChild(cell);
        }

        grid.appendChild(row);
      }
    }

    prevBtn.addEventListener('click', () => {
      currentMonth--;
      if (currentMonth < 0) {
        currentMonth = 11;
        currentYear--;
      }
      renderCalendar(currentYear, currentMonth);
    });

    nextBtn.addEventListener('click', () => {
      currentMonth++;
      if (currentMonth > 11) {
        currentMonth = 0;
        currentYear++;
      }
      renderCalendar(currentYear, currentMonth);
    });

    renderCalendar(currentYear, currentMonth);
  </script>
</body>
</html>
